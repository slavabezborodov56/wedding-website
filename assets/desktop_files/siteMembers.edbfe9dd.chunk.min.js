(window.webpackJsonp__wix_thunderbolt_app=window.webpackJsonp__wix_thunderbolt_app||[]).push([[103],{223:function(e,t,n){"use strict";n.r(t),n.d(t,"site",(function(){return N})),n.d(t,"page",(function(){return x})),n.d(t,"SiteMembersApiSymbol",(function(){return P.b})),n.d(t,"BIEvents",(function(){return T})),n.d(t,"PrivacyStatus",(function(){return O.c})),n.d(t,"INTERACTIONS",(function(){return O.b})),n.d(t,"AUTH_RESULT_REASON",(function(){return O.a})),n.d(t,"memberDetailsFromDTO",(function(){return k}));var o=n(22),i=n(0),s=n(214),r=n(389),a=n(132),c=n(397),u=n(407),l=n(408),d=n(387),m=n(398),b=n(388),g=n(262),p=n(24),h=n(5),v=n(243),f=n(220),w=n(404),S=n(8),O=n(427),C=n(468),P=n(227),D=function(){function e(e,t,n){this.propsStore=e,this.structureApi=t,this.siteScrollBlocker=n}return e.prototype.displayDialog=function(e,t,n,o){return void 0===o&&(o={}),Object(i.b)(this,void 0,Promise,(function(){var s,r,a,c=this;return Object(i.d)(this,(function(u){switch(u.label){case 0:return s=function(){return Object(i.b)(c,void 0,void 0,(function(){var o,s;return Object(i.d)(this,(function(r){switch(r.label){case 0:return o=Object(S.uniqueId)(P.a),this.propsStore.update(((s={})[o]=Object(i.a)(Object(i.a)({},t),n),s)),Object(C.b)(),[4,this.structureApi.addComponentToDynamicStructure(o,{componentType:e,components:[]})];case 1:return r.sent(),this.currentCompId&&(this.structureApi.removeComponentFromDynamicStructure(this.currentCompId),this.siteScrollBlocker.setSiteScrollingBlocked(!1,this.currentCompId)),this.siteScrollBlocker.setSiteScrollingBlocked(!0,o),this.currentCompId=o,[2]}}))}))},r=o.shouldWaitForAppDidMount,a=o.registerToAppDidMount,r&&a?(a(s),[3,3]):[3,1];case 1:return[4,s()];case 2:u.sent(),u.label=3;case 3:return[2]}}))}))},e.prototype.hideDialog=function(){this.currentCompId&&(this.structureApi.removeComponentFromDynamicStructure(this.currentCompId),this.siteScrollBlocker.setSiteScrollingBlocked(!1,this.currentCompId),Object(C.a)()),this.currentCompId=void 0},e}(),k=function(e){var t,n,o,i,s,r,a,c,u,l;return{id:e.id,emailVerified:null===(t=e.attributes)||void 0===t?void 0:t.emailVerified,role:e.memberRole,owner:e.owner,loginEmail:e.email,memberName:null!==(i=null!==(n=e.name)&&void 0!==n?n:null===(o=e.attributes)||void 0===o?void 0:o.name)&&void 0!==i?i:"",firstName:null===(s=e.attributes)||void 0===s?void 0:s.firstName,lastName:null===(r=e.attributes)||void 0===r?void 0:r.lastName,imageUrl:null!==(c=null===(a=e.attributes)||void 0===a?void 0:a.imageUrl)&&void 0!==c?c:"",nickname:null===(u=e.attributes)||void 0===u?void 0:u.nickname,profilePrivacyStatus:null===(l=e.attributes)||void 0===l?void 0:l.privacyStatus,slug:e.slug,status:e.status,creationDate:e.dateCreated,lastUpdateDate:e.dateUpdated,emails:[],phones:[],addresses:[],labels:[],groups:[],customFields:[]}},j=function(){return new Promise((function(){return 0}))},T=function(e){var t=e.sessionManager,n=e.businessLogger,o=e.wixBiSession,s=e.viewMode,r=e.language,a=function(e,n){return{biToken:o.msId,context:e,ts:y(o),viewmode:s,visitor_id:t.getVisitorId(),site_member_id:t.getSiteMemberId(),vsi:o.viewerSessionId,site_settings_lng:r.siteLanguage,browser_lng:r.userLanguage,lng_mismatch:r.siteLanguage!==r.userLanguage,layout:n}};return{loginOrSignUpDialogLoaded:function(e,t){void 0===t&&(t="fullscreen"),n.logger.log(Object(i.a)({src:5,evid:658},a(e,t)),{endpoint:"site-members"})},closingDialog:function(e,t){void 0===t&&(t="fullscreen"),n.logger.log(Object(i.a)({src:5,evid:602,form_type:"default"},a(e,t)),{endpoint:"site-members"})},emailAuthSubmitClicked:function(e,t){n.logger.log(Object(i.a)({src:5,evid:603,form_type:"default"},a(e,t)),{endpoint:"site-members"})},siteMembersFeatureLoaded:function(){n.logger.log(Object(i.a)({src:5,evid:698},a()),{endpoint:"site-members"})},siteMembersSdkFeatureLoaded:function(){n.logger.log(Object(i.a)({src:5,evid:699},a()),{endpoint:"site-members"})}}},y=function(e){var t=e.initialTimestamp||0;return Date.now()-t},L=function(){function e(e){this.shouldRunCustomPopupCloseCallback=!0,this.popups=e}return e.prototype.openPopupPage=function(e,t,n){var o;return Object(i.b)(this,void 0,void 0,(function(){var s,r=this;return Object(i.d)(this,(function(i){switch(i.label){case 0:return s=this.shouldRunCustomPopupCloseCallback,this.shouldRunCustomPopupCloseCallback=!1,this.assignRequestAuthenticationRejection(t),[4,null===(o=this.popups)||void 0===o?void 0:o.openPopupPage(e,(function(){r.shouldRunCustomPopupCloseCallback&&(r.rejectAuthenticationRequest(),n&&n())}))];case 1:return i.sent(),this.shouldRunCustomPopupCloseCallback=s,[2]}}))}))},e.prototype.preventCustomPopupCloseCallback=function(){this.shouldRunCustomPopupCloseCallback=!1},e.prototype.allowCustomPopupCloseCallback=function(){this.shouldRunCustomPopupCloseCallback=!0},e.prototype.assignRequestAuthenticationRejection=function(e){this.requestAuthenticationRejection=this.requestAuthenticationRejection||e},e.prototype.rejectAuthenticationRequest=function(){this.requestAuthenticationRejection&&(this.requestAuthenticationRejection(O.a.CANCELED),this.requestAuthenticationRejection=void 0)},e}(),E=function(e,t,n){return function(o,s){void 0===s&&(s={});var r=Object(i.a)(Object(i.a)(Object(i.a)(Object(i.a)({},t.headers),s.body?{"Content-Type":"application/x-www-form-urlencoded"}:{}),s.headers),{"x-wix-client-artifact-id":"thunderbolt"}),a=Object(i.a)(Object(i.a)({},s),{headers:r}),c=new URL(o,n).href;return e.envFetch(c,Object(i.a)(Object(i.a)({},t),a)).then((function(e){return Object(i.b)(void 0,void 0,void 0,(function(){var t;return Object(i.d)(this,(function(n){switch(n.label){case 0:return[4,e.json()];case 1:if(t=n.sent(),!e.ok)throw t;return[2,t]}}))}))}))}},I=function(e,t,n){document.cookie=e+"=;max-age=0",document.cookie=e+"=;max-age=0;path="+t,document.cookie=e+"=;domain="+n+";max-age=0",document.cookie=e+"=;domain="+n+";max-age=0;path="+t},A=Object(o.h)([Object(o.f)(s.f,P.c),Object(o.f)(s.d,P.c),r.a,a.f,a.p,p.a,c.b,c.d,a.e,a.b,h.e,v.a,u.a,h.i,l.a,d.b,Object(o.g)(f.d),Object(o.g)(w.a),m.a,b.a],(function(e,t,n,o,s,r,a,c,u,l,d,m,b,p,h,v,f,w,C,P){var y,A;void 0===w&&(w={trackEvent:function(){return 0}});var R=e.collectionExposure,_=e.smcollectionId,M=e.svSession,U=e.smSessionCookie,N=e.protectedHomepage,x=e.isCommunityInstalled,q=e.memberInfoAppId,F=e.sm_efCookie,W="WixInternal"===R,B=r.getAppInstanceByAppDefId("22bef345-3c5b-4c18-b782-74d4085112ff"),V=null!==(y=r.getVisitorId())&&void 0!==y?y:"00000000-0000-0000-0000-000000000000",G=t.smSettings,H=t.tpaApplicationIds,z=t.policyLinks,K=q&&H[q],Y=s.site,J=Y.siteRevision,X=Y.metaSiteId,$=Y.siteId,Q=Y.externalBaseUrl,Z=s.requestUrl,ee=s.viewMode,te="/_api/wix-sm-webapp/tokens/verify/"+X+"/"+$,ne=Q.replace(/\/$/,"")+"/api/wix-sm/v1/authorize/"+$+"/pages",oe="/_api/wix-sm-webapp/tokens/logout/"+X,ie="/_api/wix-sm-webapp/member/changePasswordWithMailToken?metaSiteId="+X+"&collectionId="+_,se="/_api/wix-sm-webapp/social/token/handle?metaSiteId="+X+"&collectionId="+_,re=Q.replace(/\/$/,"")+"/_api/dynamicmodel",ae=G.smFirstDialogLogin?"login":"signup",ce=G.socialLoginFacebookEnabled,ue=G.socialLoginGoogleEnabled,le=G.termsOfUse,de=G.privacyPolicy,me=G.codeOfConduct,be=G.customSignUpPageId,ge=G.customSignInPageId,pe=null===(A=G.joinCommunityCheckedByDefault)||void 0===A||A,he=e.smToken,ve={},fe=U,we=null,Se=!1,Oe=function(e){we=e},Ce=function(){var e=!C.getCurrentRouteInfo();return{registerToAppDidMount:Oe,shouldWaitForAppDidMount:!Se&&e}},Pe={},De={},ke=T({sessionManager:r,businessLogger:h,wixBiSession:v,viewMode:null==ee?void 0:ee.toUpperCase(),language:u});ke.siteMembersFeatureLoaded();var je={},Te=E(n,{credentials:"same-origin",headers:{accept:"application/json","x-wix-site-revision":""+J,"x-wix-client-artifact-id":"thunderbolt"}},s.requestUrl),ye=function(e,t,n){return new D(e,t,n)}(a,c,m),Le=P["specs.thunderbolt.sm_googleAuthViaSDK"],Ee=new L(f),Ie={appDidMount:function(){we&&we(),Se=!0},login:function(e,t,n,o){return void 0===o&&(o=!1),Object(i.b)(this,void 0,Promise,(function(){var s,r,a;return Object(i.d)(this,(function(i){switch(i.label){case 0:w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Submit",eventLabel:"Wix"}}),i.label=1;case 1:return i.trys.push([1,4,,5]),[4,Ie.performLogin(e,t,n)];case 2:return s=i.sent(),[4,Ie.handleLoginResponse(s,o)];case 3:return r=i.sent(),w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Success",eventLabel:"Wix"}}),[2,r];case 4:throw a=i.sent(),w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Failure",eventLabel:"Wix"}}),a;case 5:return[2]}}))}))},performLogin:function(e,t,n){var o;return Object(i.b)(this,void 0,Promise,(function(){var s,r,a,c,u,l,d,m,b;return Object(i.d)(this,(function(i){switch(i.label){case 0:return P["specs.thunderbolt.sm_platformizedLogin"]?[4,Te("/_api/wix-sm-webapp/v1/auth/login",{method:"POST",headers:{"Content-Type":"application/json",authorization:B||""},body:JSON.stringify({email:e,password:t,recaptchaToken:null==n?void 0:n.recaptchaToken})})]:[3,2];case 1:return[2,{member:(s=i.sent()).member,token:null===(o=null==s?void 0:s.session)||void 0===o?void 0:o.token}];case 2:return r=encodeURIComponent(e),a=encodeURIComponent(t),c="email="+r+"&password="+a+"&collectionId="+_+"&metaSiteId="+X+"&appUrl="+Z+"&svSession="+M,(null==n?void 0:n.recaptchaToken)&&(c=c+"&recaptchaToken="+n.recaptchaToken),[4,Te("/_api/wix-sm-webapp/member/login",{method:"POST",body:c})];case 3:if(u=i.sent(),l=u.errorCode,d=u.payload,l)throw l;return m=d.sessionToken,b=d.siteMemberDto,[2,{member:k(b),token:m}]}}))}))},handleOauthToken:function(e,t,n,s,a){return void 0===a&&(a=!1),Object(i.b)(this,void 0,Promise,(function(){var c,l,d,m,b,g,p,h;return Object(i.d)(this,(function(i){switch(i.label){case 0:return c=r.getVisitorId(),o.interactionStarted(O.b.SOCIAL_APP_LOGIN),w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Submit",eventLabel:t}}),[4,Te(se,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({svSession:M,visitorId:c,token:e,provider:t,mode:n,lang:u.userLanguage,privacyStatus:s})})];case 1:if(l=i.sent(),d=l.errorCode,m=l.payload,d)throw w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Failure",eventLabel:t}}),d;return o.interactionEnded(O.b.SOCIAL_APP_LOGIN),m.smSession&&(g=m.smSession.siteMemberDto,b=m.smSession.sessionToken),g=m.siteMemberDto,p=k(g),[4,Ie.handleLoginResponse({member:p,token:b},a)];case 2:return h=i.sent(),w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Success",eventLabel:t}}),[2,h]}}))}))},handleSocialLoginResponse:function(e,t,n){return void 0===n&&(n=!1),Object(i.b)(this,void 0,Promise,(function(){var s,r,a,c;return Object(i.d)(this,(function(i){switch(i.label){case 0:return o.interactionStarted(O.b.SOCIAL_APP_LOGIN),o.interactionEnded(O.b.SOCIAL_APP_LOGIN),w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Submit",eventLabel:t}}),e.smSession&&(r=e.smSession.siteMemberDto,s=e.smSession.sessionToken),r=e.siteMemberDto,a=k(r),[4,Ie.handleLoginResponse({member:a,token:s},n)];case 1:return c=i.sent(),w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Success",eventLabel:t}}),[2,c]}}))}))},handleLoginResponse:function(e,t){var n=e.token,o=e.member;return void 0===t&&(t=!1),Object(i.b)(this,void 0,Promise,(function(){var e,s,r;return Object(i.d)(this,(function(a){switch(a.label){case 0:return e=o.emailVerified,n||e||"ACTIVE"!==o.status?[3,2]:[4,Ie.showConfirmationEmailDialog(o.id)];case 1:return a.sent(),[2,j()];case 2:return n?[3,5]:[4,b()];case 3:return s=a.sent(),[4,Ie.showNotificationDialog("",(s("siteMembersTranslations","SMApply_Success1","Success! Your member signup request has been sent and is awaiting approval.")+" "+s("siteMembersTranslations","SMApply_Success2","The site administrator will notify you via email ({0}) once your request has been approved.")).replace("{0}",o.loginEmail),s("siteMembersTranslations","SMContainer_OK","OK"))];case 4:return a.sent(),[2,j()];case 5:return[4,Ie.applySessionToken(n,o,t)];case 6:return r=a.sent(),[2,Object(i.a)({sessionToken:n,member:o},t?{pages:r}:{})]}}))}))},promptLogin:function(e,t,n){void 0===e&&(e={}),void 0===t&&(t=!0),void 0===n&&(n=!1);var o=e.mode,i=e.modal,s=null!=o?o:ae,r=i&&P["specs.thunderbolt.sm_displayLoginAsAPopup"]?"popup":"fullscreen";return"login"===s?Ie.showLoginDialog(t,r,n):Ie.showSignUpDialog(t,r,n)},promptForgotPassword:function(e){return void 0===e&&(e=!0),new Promise((function(t,n){Ee.assignRequestAuthenticationRejection(n);var o={isCloseable:e},s={onCloseDialogCallback:function(){ke.closingDialog("RequestResetPassword"),ye.hideDialog(),Ee.rejectAuthenticationRequest()},onSubmitCallback:function(e){var n=this;return Ie.sendForgotPasswordMail(e).then((function(){return Object(i.b)(n,void 0,void 0,(function(){var e;return Object(i.d)(this,(function(n){switch(n.label){case 0:return[4,b()];case 1:return e=n.sent(),Ie.showNotificationDialog(e("siteMembersTranslations","siteMembersTranslations_RESET_PASSWORD_CHECKEMAIL_TITLE","Please Check Your Email"),e("siteMembersTranslations","siteMembersTranslations_RESET_PASSWORD_CHECKEMAIL_TEXT","We\u2019ve emailed you a link to reset your password."),e("siteMembersTranslations","siteMembersTranslations_Reset_Password_OK","Got It")),t(),[2]}}))}))}))}};ye.displayDialog("RequestPasswordResetDialog",o,s)}))},requestAuthentication:function(e){return void 0===e&&(e={}),Object(i.b)(this,void 0,Promise,(function(){var t;return Object(i.d)(this,(function(n){switch(n.label){case 0:if(fe)return[2,{success:!0,token:fe,reason:O.a.ALREADY_LOGGED_IN}];n.label=1;case 1:return n.trys.push([1,3,,4]),t=!N,[4,Ie.promptLogin(e,t)];case 2:return[2,{success:!0,token:n.sent().sessionToken,reason:O.a.SUCCESS}];case 3:return[2,{success:!1,reason:n.sent()}];case 4:return[2]}}))}))},requestAuthorizedPages:function(e){return void 0===e&&(e={}),Object(i.b)(this,void 0,Promise,(function(){var t,n;return Object(i.d)(this,(function(o){switch(o.label){case 0:return he?(n={success:!0},[4,Ie.authorizeMemberPagesBySignedInstance(he)]):[3,2];case 1:return[2,(n.pages=o.sent(),n)];case 2:return o.trys.push([2,4,,5]),t=!N,[4,Ie.promptLogin(e,t,!0)];case 3:return[2,{success:!0,pages:o.sent().pages}];case 4:return[2,{success:!1,reason:o.sent()}];case 5:return[2]}}))}))},applySessionToken:function(e,t,n){return void 0===n&&(n=!1),Object(i.b)(this,void 0,Promise,(function(){var s,a,c,u;return Object(i.d)(this,(function(l){switch(l.label){case 0:return o.interactionStarted(O.b.VERIFY_TOKEN),[4,Te(te,{method:"POST",body:"token="+e})];case 1:if(s=l.sent(),a=s.payload,c=s.errorCode)throw c;return o.interactionEnded(O.b.VERIFY_TOKEN),[4,r.loadNewSession({reason:"memberLogin"})];case 2:return l.sent(),[4,Ie.getSmToken()];case 3:return he=l.sent(),fe=e,null==t?[3,4]:(u=t,[3,6]);case 4:return[4,Ie.getMemberDetails()];case 5:u=l.sent(),l.label=6;case 6:return ve=u,[4,Promise.all(Object.values(Pe).map((function(e){return Object(i.b)(void 0,void 0,void 0,(function(){var t;return Object(i.d)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e()];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),o.captureError(t,{tags:{feature:"site-members"}}),[3,3];case 3:return[2]}}))}))})))];case 7:return l.sent(),n?[2,a.pages]:[2]}}))}))},getSmToken:function(){return Object(i.b)(this,void 0,Promise,(function(){var e;return Object(i.d)(this,(function(t){switch(t.label){case 0:return[4,n.envFetch(re).then((function(e){return e.json()}))];case 1:return e=t.sent().clientSpecMap,[2,Object.values(e).find((function(e){return"sitemembers"===e.type})).smtoken]}}))}))},authorizeMemberPagesByCookie:function(){return Object(i.b)(this,void 0,Promise,(function(){var e,t,n,o;return Object(i.d)(this,(function(i){switch(i.label){case 0:return e=Object(g.e)(l)?{headers:{cookie:"smSession="+U}}:void 0,[4,Te(ne,e)];case 1:if(t=i.sent(),n=t.authorizedPages,o=t.errorCode)throw o;return[2,n]}}))}))},authorizeMemberPagesByToken:function(e){return Object(i.b)(this,void 0,Promise,(function(){var t,n,o;return Object(i.d)(this,(function(i){switch(i.label){case 0:return e===U?[2,this.authorizeMemberPagesByCookie()]:[4,Te(te,{method:"POST",body:"token="+e})];case 1:if(t=i.sent(),n=t.payload,o=t.errorCode)throw o;return[2,n.pages]}}))}))},authorizeMemberPagesBySignedInstance:function(e){return Object(i.b)(this,void 0,Promise,(function(){var t,n,o;return Object(i.d)(this,(function(i){switch(i.label){case 0:return[4,Te(ne,{headers:{authorization:e}})];case 1:if(t=i.sent(),n=t.authorizedPages,o=t.errorCode)throw o;return[2,n]}}))}))},getMemberDetails:function(e){return void 0===e&&(e=!1),Object(i.b)(this,void 0,Promise,(function(){var t,n,s;return Object(i.d)(this,(function(r){switch(r.label){case 0:return!ve.id||e?[3,1]:[2,ve];case 1:return he?[4,Te("/_api/wix-sm-webapp/member/"+he+"?collectionId="+_+"&metaSiteId="+X)]:[3,5];case 2:if(t=r.sent(),n=t.payload,s=t.errorCode)throw s;return ve=k(n),e?[4,Promise.all(Object.values(je).map((function(e){return Object(i.b)(void 0,void 0,void 0,(function(){var t;return Object(i.d)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e()];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),o.captureError(t,{tags:{feature:"site-members"}}),[3,3];case 3:return[2]}}))}))})))]:[3,4];case 3:r.sent(),r.label=4;case 4:return[2,ve];case 5:return[2,null]}}))}))},register:function(e,t,n,s,r,a){return void 0===a&&(a=!1),Object(i.b)(this,void 0,Promise,(function(){var c,u,l,d,m,g,p,h,v,f,S;return Object(i.d)(this,(function(C){switch(C.label){case 0:return C.trys.push([0,9,,10]),o.interactionStarted(O.b.CODE_SIGNUP),w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Sign up Submit",eventLabel:"Wix"}}),c={email:e,password:t,profilePrivacyStatus:s,contactInfo:n,defaultFlow:r},[4,Te("/_api/wix-sm-webapp/v1/auth/signup",{method:"POST",headers:{"Content-Type":"application/json",authorization:B||""},body:JSON.stringify(c)})];case 1:return u=C.sent(),l=u.member,d=u.approvalToken,m=u.session,g=l.emailVerified,p=null==m?void 0:m.token,h="ACTIVE"===(null==l?void 0:l.status)?"ACTIVE":"PENDING",p||g||"ACTIVE"!==l.status?[3,3]:[4,Ie.showConfirmationEmailDialog(l.id)];case 2:return C.sent(),o.interactionEnded(O.b.CODE_SIGNUP),[2,{member:l,status:h}];case 3:return r&&"APPLICANT"===(null==l?void 0:l.status)||!p?[4,b()]:[3,6];case 4:return v=C.sent(),[4,Ie.showNotificationDialog("",(v("siteMembersTranslations","SMApply_Success1","Success! Your member login request has been sent and is awaiting approval.")+" "+v("siteMembersTranslations","SMApply_Success2","The site administrator will notify you via email ({0}) once your request has been approved.")).replace("{0}",e),v("siteMembersTranslations","SMContainer_OK","OK"))];case 5:return C.sent(),o.interactionEnded(O.b.CODE_SIGNUP),[2,{member:l,status:h,approvalToken:d}];case 6:return[4,Ie.applySessionToken(p,l,a)];case 7:return f=C.sent(),o.interactionEnded(O.b.CODE_SIGNUP),w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Sign up Success",eventLabel:"Wix"}}),[2,Object(i.a)({member:l,status:h,sessionToken:p},a&&f?{pages:f}:{})];case 8:return[3,10];case 9:throw S=C.sent(),w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Sign up Failure",eventLabel:"Wix"}}),S;case 10:return[2]}}))}))},sendForgotPasswordMail:function(e){return Object(i.b)(this,void 0,void 0,(function(){var t,n,s,r;return Object(i.d)(this,(function(i){switch(i.label){case 0:return o.interactionStarted(O.b.RESET_PASSWORD),t=u.userLanguage,n=encodeURIComponent(Z),s=encodeURIComponent(e),[4,Te("/_api/wix-sm-webapp/member/sendForgotPasswordMail",{method:"POST",body:"returnUrl="+n+"&collectionId="+_+"&metaSiteId="+X+"&lang="+t+"&email="+s})];case 1:if(r=i.sent().errorCode)throw r;return o.interactionEnded(O.b.RESET_PASSWORD),[2]}}))}))},changePassword:function(e,t){return Object(i.b)(this,void 0,void 0,(function(){var n,o;return Object(i.d)(this,(function(i){switch(i.label){case 0:return n=encodeURIComponent(e),[4,Te(ie,{method:"POST",body:"newPassword="+n+"&forgotPasswordToken="+t})];case 1:if(o=i.sent().errorCode)throw o;return[2]}}))}))},resendEmailVerification:function(e){return Object(i.b)(this,void 0,void 0,(function(){var t;return Object(i.d)(this,(function(n){switch(n.label){case 0:return[4,Te("/_api/wix-sm-webapp/tokens/email/resend/"+e)];case 1:if(t=n.sent().errorCode)throw t;return[2]}}))}))},logout:function(e){return Object(i.b)(this,void 0,void 0,(function(){var t;return Object(i.d)(this,(function(n){switch(n.label){case 0:return he?[4,Te(oe,{method:"POST"})]:[2];case 1:return n.sent(),[4,Promise.all(Object.values(De).map((function(e){return Object(i.b)(void 0,void 0,void 0,(function(){var t;return Object(i.d)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e()];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),o.captureError(t,{tags:{feature:"site-members"}}),[3,3];case 3:return[2]}}))}))})))];case 2:return n.sent(),e?(t="./"+e.replace(/^\//,""),[4,d.navigate(t)]):[3,4];case 3:n.sent(),n.label=4;case 4:return Object(g.e)(l)||l.document.location.reload(),[2]}}))}))},registerToUserLogin:function(e){var t=Object(S.uniqueId)("callback");return Pe[t]=e,t},unRegisterToUserLogin:function(e){delete Pe[e]},registerToMemberLogout:function(e){var t=Object(S.uniqueId)("logout_callback");return De[t]=e,t},unRegisterToMemberLogout:function(e){delete De[e]},registerToMemberDetailsRefresh:function(e){var t=Object(S.uniqueId)("mdrcb");return je[t]=e,t},unRegisterToMemberDetailsRefresh:function(e){delete je[e]},showWelcomeDialog:function(e){return void 0===e&&(e=!0),Object(i.b)(this,void 0,void 0,(function(){var t,n;return Object(i.d)(this,(function(o){return t={isCloseable:e},n={onCloseDialogCallback:function(){ke.closingDialog("WelcomeDialog");var e=new URL(s.requestUrl).hostname,t=0===e.indexOf("www")?e.substr(3):e;I("sm_ef","/",t),F="",ye.hideDialog()},onSubmitCallback:function(){var e=new URL(s.requestUrl).hostname,t=0===e.indexOf("www")?e.substr(3):e;I("sm_ef","/",t),F="",ye.hideDialog(),K&&d.navigate("./account/my-account")}},ye.displayDialog("WelcomeDialog",t,n),[2]}))}))},showNoPermissionsToPageDialog:function(e){return Object(i.b)(this,void 0,void 0,(function(){var t;return Object(i.d)(this,(function(n){return t={onCloseDialogCallback:function(){ye.hideDialog(),e&&e()},onSwitchAccountLinkClick:function(){Ie.logout()}},ye.displayDialog("NoPermissionsToPageDialog",{},t),[2]}))}))},showResetPasswordDialog:function(e){return Object(i.b)(this,void 0,void 0,(function(){var t,n;return Object(i.d)(this,(function(o){return t={isCloseable:!0},n={onCloseDialogCallback:function(){ke.closingDialog("ResetPasswordDialog");var e=p.getParsedUrl();e.searchParams.delete("forgotPasswordToken"),e.searchParams.delete("forgotPasswordLang"),p.pushUrlState(e),ye.hideDialog()},onSubmitCallback:function(n){return Object(i.b)(this,void 0,void 0,(function(){var o;return Object(i.d)(this,(function(i){switch(i.label){case 0:return[4,b()];case 1:return o=i.sent(),[2,Ie.changePassword(n,e).then((function(){Ie.showNotificationDialog(o("siteMembersTranslations","siteMembersTranslations_Reset_Password_Sucess_Title","Your password has been changed."),"",o("siteMembersTranslations","SMContainer_OK","OK"),(function(){Ie.showLoginDialog();var e=p.getParsedUrl();e.searchParams.delete("forgotPasswordToken"),e.searchParams.delete("forgotPasswordLang"),p.pushUrlState(e)}))})).catch((function(e){var n=s.experiments["specs.thunderbolt.sm_redirectToResetPasswordLinkOnTokenExpired"];if(-19972!==e||!n)throw e;Ie.showNotificationDialog(o("siteMembersTranslations","siteMembersTranslations_PASSWORD_HAS_EXPIRED_TITLE","Your link to create a new password has expired"),o("siteMembersTranslations","siteMembersTranslations_PASSWORD_HAS_EXPIRED_TEXT","To continue, resend a new link to your email."),o("siteMembersTranslations","siteMembersTranslations_PASSWORD_HAS_EXPIRED_OK","Resend Link"),(function(){return Ie.promptForgotPassword(t.isCloseable)}))}))]}}))}))}},ye.displayDialog("ResetPasswordDialog",t,n),[2]}))}))},showLoginDialog:function(e,t,n){return void 0===e&&(e=!0),void 0===t&&(t="fullscreen"),void 0===n&&(n=!1),Object(i.b)(this,void 0,Promise,(function(){var s=this;return Object(i.d)(this,(function(r){return ge&&(null==f?void 0:f.isPopupPage(ge))?[2,Ie.showCustomAuthenticationDialog(ge,n)]:[2,new Promise((function(r,a){return Object(i.b)(s,void 0,void 0,(function(){var s,c;return Object(i.d)(this,(function(i){switch(i.label){case 0:return Ee.assignRequestAuthenticationRejection(a),s={displayMode:t,language:u.userLanguage,isCloseable:e,smCollectionId:_,svSession:M,biVisitorId:V,metaSiteId:X,isSocialLoginGoogleEnabled:ue,isSocialLoginFacebookEnabled:!W&&ce,isEmailLoginEnabled:!W,useGoogleSdk:Le},c={onCloseDialogCallback:function(){ye.hideDialog(),ke.closingDialog("MemberLoginDialog",t),Ee.rejectAuthenticationRequest()},submit:function(e,i,s){return o.interactionStarted(O.b.DEFAULT_LOGIN),ke.emailAuthSubmitClicked("MemberLoginDialog",t),Ie.login(e,i,s,n).then((function(e){o.interactionEnded(O.b.DEFAULT_LOGIN),ye.hideDialog(),r(e)}))},onForgetYourPasswordClick:function(){Ie.promptForgotPassword(e)},onSwitchDialogLinkClick:function(){Ie.showSignUpDialog(e,t).then(r,(function(){Ee.rejectAuthenticationRequest()}))},onTokenMessage:function(e,t,o){void 0===o&&(o=!1);var i=o?"PUBLIC":"PRIVATE";return Ie.handleOauthToken(e,t,"memberLoginDialog",i,n).then((function(e){ye.hideDialog(),r(e)}))},onBackendSocialLogin:function(e,t){return Ie.handleSocialLoginResponse(e,t,n).then((function(e){ye.hideDialog(),r(e)}))},getHostReadyPayload:function(){return{visitorId:V,svSession:M}}},ke.loginOrSignUpDialogLoaded("MemberLoginDialog",t),[4,ye.displayDialog("MemberLoginDialog",s,c,Ce())];case 1:return i.sent(),Ie.closeCustomAuthenticationDialogs(!0),[2]}}))}))}))]}))}))},showSignUpDialog:function(e,t,n){return void 0===e&&(e=!0),void 0===t&&(t="fullscreen"),void 0===n&&(n=!1),Object(i.b)(this,void 0,Promise,(function(){var s=this;return Object(i.d)(this,(function(r){return be&&(null==f?void 0:f.isPopupPage(be))?[2,Ie.showCustomAuthenticationDialog(be,n)]:[2,new Promise((function(r,a){return Object(i.b)(s,void 0,void 0,(function(){var s,c;return Object(i.d)(this,(function(l){switch(l.label){case 0:return Ee.assignRequestAuthenticationRejection(a),s={displayMode:t,language:u.userLanguage,isCloseable:e,smCollectionId:_,biVisitorId:V,svSession:M,metaSiteId:X,isSocialLoginGoogleEnabled:ue,isSocialLoginFacebookEnabled:!W&&ce,isEmailLoginEnabled:!W,isCommunityInstalled:x,joinCommunityCheckedByDefault:pe,isTermsOfUseNeeded:!(!(null==le?void 0:le.enabled)||!z.termsOfUse),isPrivacyPolicyNeeded:!(!(null==de?void 0:de.enabled)||!z.privacyPolicy),isCodeOfConductNeeded:!(!(null==me?void 0:me.enabled)||!z.codeOfConduct),termsOfUseLink:z.termsOfUse,privacyPolicyLink:z.privacyPolicy,codeOfConductLink:z.codeOfConduct,useGoogleSdk:Le},c={onCloseDialogCallback:function(){ye.hideDialog(),ke.closingDialog("SignUpDialog",t),Ee.rejectAuthenticationRequest()},submit:function(e,s,a){var c="boolean"==typeof a?a:a.isCommunityChecked;o.interactionStarted(O.b.DEFAULT_SIGNUP),ke.emailAuthSubmitClicked("SignUpDialog",t);var u=c?O.c.PUBLIC:O.c.PRIVATE;return Ie.register(e,s,void 0,u,void 0,n).then((function(e){o.interactionEnded(O.b.DEFAULT_SIGNUP);var t=e.member,s=e.sessionToken,a=e.pages;s&&(ye.hideDialog(),r(Object(i.a)({member:t,sessionToken:s},n?{pages:a}:{})))}))},onSwitchDialogLinkClick:function(){Ie.showLoginDialog(e,t,n).then(r,(function(){Ee.rejectAuthenticationRequest()}))},onTokenMessage:function(e,t,o){void 0===o&&(o=!1);var i=o?"PUBLIC":"PRIVATE";return Ie.handleOauthToken(e,t,"memberLoginDialog",i,n).then((function(e){ye.hideDialog(),r(e)}))},onBackendSocialLogin:function(e,t){return Ie.handleSocialLoginResponse(e,t,n).then((function(e){ye.hideDialog(),r(e)}))},getHostReadyPayload:function(){return{visitorId:V,svSession:M}}},ke.loginOrSignUpDialogLoaded("SignUpDialog",t),[4,ye.displayDialog("SignUpDialog",s,c,Ce())];case 1:return l.sent(),Ie.closeCustomAuthenticationDialogs(!0),[2]}}))}))}))]}))}))},showNotificationDialog:function(e,t,n,o,s){return void 0===o&&(o=function(){return 0}),void 0===s&&(s=function(){return 0}),Object(i.b)(this,void 0,void 0,(function(){var r,a;return Object(i.d)(this,(function(i){switch(i.label){case 0:return r={isCloseable:!0,title:e,description:t,okButtonText:n},a={onCloseDialogCallback:function(){ke.closingDialog("NotificationDialog"),ye.hideDialog(),s()},onOkButtonClick:function(){ye.hideDialog(),o()}},[4,ye.displayDialog("NotificationDialog",r,a)];case 1:return i.sent(),[2]}}))}))},showConfirmationEmailDialog:function(e,t){return void 0===t&&(t=!0),Object(i.b)(this,void 0,void 0,(function(){var n,o;return Object(i.d)(this,(function(s){switch(s.label){case 0:return n={isCloseable:!0,isSignUp:t},o={onCloseDialogCallback:function(){ke.closingDialog("ConfirmationEmailDialog"),ye.hideDialog()},onResendConfirmationEmail:function(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return[4,Ie.resendEmailVerification(e)];case 1:return t.sent(),[4,Ie.showConfirmationEmailDialog(e,!1)];case 2:return t.sent(),[2]}}))}))}},[4,ye.displayDialog("ConfirmationEmailDialog",n,o)];case 1:return s.sent(),[2]}}))}))},showCustomAuthenticationDialog:function(e,t){return void 0===t&&(t=!1),Object(i.b)(this,void 0,Promise,(function(){var n=this;return Object(i.d)(this,(function(o){if(!f)throw new Error("popup unavailable");return[2,new Promise((function(o,s){return Object(i.b)(n,void 0,void 0,(function(){var n,r=this;return Object(i.d)(this,(function(a){switch(a.label){case 0:return n=Ie.registerToUserLogin((function(){return Object(i.b)(r,void 0,void 0,(function(){var s,r,a,c;return Object(i.d)(this,(function(u){switch(u.label){case 0:return s=o,r=[{member:ve,sessionToken:fe}],t?(c={},[4,Ie.authorizeMemberPagesBySignedInstance(he)]):[3,2];case 1:return c.pages=u.sent(),a=c,[3,3];case 2:a={},u.label=3;case 3:return s.apply(void 0,[i.a.apply(void 0,r.concat([a]))]),Ie.unRegisterToUserLogin(n),f.getCurrentPopupId()===e&&f.closePopupPage(),[2]}}))}))})),[4,Ee.openPopupPage(e,s,(function(){Ie.unRegisterToUserLogin(n)}))];case 1:return a.sent(),ye.hideDialog(),[2]}}))}))}))]}))}))},closeCustomAuthenticationDialogs:function(e){return void 0===e&&(e=!1),Object(i.b)(this,void 0,void 0,(function(){var t;return Object(i.d)(this,(function(n){switch(n.label){case 0:return(t=null==f?void 0:f.getCurrentPopupId())&&[be,ge].includes(t)?(e&&Ee.preventCustomPopupCloseCallback(),[4,f.closePopupPage()]):[3,2];case 1:n.sent(),Ee.allowCustomPopupCloseCallback(),n.label=2;case 2:return[2]}}))}))},getForgotPasswordToken:function(){return new URL(Object(g.e)(l)?s.requestUrl:location.href).searchParams.get("forgotPasswordToken")},shouldDisplayWelcomeDialog:function(){return F&&K},willDisplayDialogOnAppWillMount:function(){return!(!Ie.getForgotPasswordToken()&&!Ie.shouldDisplayWelcomeDialog())},appWillMount:function(){var e=Ie.getForgotPasswordToken();if(e)Ie.showResetPasswordDialog(e);else if(Ie.shouldDisplayWelcomeDialog())Ie.showWelcomeDialog();else{switch(new URL(s.requestUrl).searchParams.get("showDialog")){case"MemberLoginDialog":Ie.showLoginDialog();break;case"SignUpDialog":Ie.showSignUpDialog();break;case"RequestPasswordResetDialog":Ie.promptForgotPassword();break;case"ResetPasswordDialog":Ie.showResetPasswordDialog("faketoken");break;case"WelcomeDialog":Ie.showWelcomeDialog();break;case"NoPermissionsToPageDialog":Ie.showNoPermissionsToPageDialog();break;case"NotificationDialog":Ie.showNotificationDialog("title","description","ok");break;case"ConfirmationEmailDialog":Ie.showConfirmationEmailDialog("fakemember")}}},pageWillUnmount:function(e){var t=e.pageId;[be,ge].includes(t)||ye.hideDialog()},getSocialAuthComponentProps:function(e){return{biVisitorId:"00000000-0000-0000-0000-000000000000",svSession:M,smCollectionId:_,metaSiteId:X,onTokenMessage:function(e,t,n){void 0===n&&(n=!1);var o=n?"PUBLIC":"PRIVATE";return Ie.handleOauthToken(e,t,"socialAuthComponent",o)},onBackendSocialLogin:Ie.handleSocialLoginResponse,getHostReadyPayload:function(){return{visitorId:V,svSession:M}}}}};return Ie})),R=n(396),_=n(409),M=Object(o.h)([P.b,b.a],(function(e,t){return{getTpaHandlers:function(){var n=this,o=function(o,s,r){return Object(i.b)(n,void 0,Promise,(function(){var n,o,s,a;return Object(i.d)(this,(function(i){switch(i.label){case 0:return[4,e.getMemberDetails()];case 1:return(n=i.sent())?!(null===(o=r.appClientSpecMapData)||void 0===o?void 0:o.isWixTPA)&&t["specs.thunderbolt.removePiiFromSMTPAs"]?[2,{id:n.id,owner:n.owner,status:n.status}]:[2,{attributes:{firstName:null!==(s=n.firstName)&&void 0!==s?s:"",lastName:null!==(a=n.lastName)&&void 0!==a?a:"",privacyStatus:n.profilePrivacyStatus},name:n.memberName,email:n.loginEmail,id:n.id,owner:n.owner,status:n.status}]:[2,null]}}))}))},s=function(t,o){return void 0===o&&(o={}),Object(i.b)(n,void 0,Promise,(function(){var t,n,s;return Object(i.d)(this,(function(i){switch(i.label){case 0:return[4,e.promptLogin({mode:o.mode,modal:o.modal})];case 1:return t=i.sent().member,[2,{attributes:{firstName:null!==(n=t.firstName)&&void 0!==n?n:"",lastName:null!==(s=t.lastName)&&void 0!==s?s:"",privacyStatus:t.profilePrivacyStatus},name:t.memberName,email:t.loginEmail,id:t.id,owner:t.owner,status:t.status}]}}))}))};return{currentMember:o,smCurrentMember:o,logOutCurrentMember:function(t,n){e.logout(null==n?void 0:n.url)},requestLogin:s,smRequestLogin:s}}}})),U=Object(o.h)([P.b,Object(o.f)(s.e,P.c),c.b],(function(e,t,n){var o=t.componentIds;return{pageWillMount:function(){return Object(i.b)(this,void 0,void 0,(function(){var t;return Object(i.d)(this,(function(s){return t=o.reduce((function(t,o){var s,r=e.getSocialAuthComponentProps(n.get(o));return Object(i.a)(Object(i.a)({},t),((s={})[o]=r,s))}),{}),n.update(t),[2]}))}))}}})),N=function(e){e(P.b,R.a.AppWillMountHandler,R.a.AppDidMountHandler).to(A)},x=function(e){e(_.b).to(M),e(R.a.PageWillMountHandler).to(U),e(R.a.PageWillUnmountHandler).to(Object(o.h)([P.b],(function(e){return{pageWillUnmount:function(t){return e.pageWillUnmount(t)}}})))}}}]);
//# sourceMappingURL=https://static.parastorage.com/services/wix-thunderbolt/dist/siteMembers.edbfe9dd.chunk.min.js.map